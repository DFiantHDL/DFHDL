package DFiant.core
import singleton.ops._
import singleton.twoface._

object Prev extends Checked0Param.Int {
  type Cond[P] = (P >= 0)
  type Msg[P] = "Prev step must be a natural number. Found step = " + ToString[P]

  trait Builder[L <: DFAny] {
    def apply[P](left : L, right : Checked[P]) : L
  }
  object Builder {
    ///////////////////////////////////////////////////////////////////////////////////////////////////////////
    // DFBits
    ///////////////////////////////////////////////////////////////////////////////////////////////////////////
    implicit def fromDFBits[LW] : Builder[DFBits[LW]] = new Builder[DFBits[LW]] {
      def apply[P](left : DFBits[LW], right : Checked[P]) : DFBits[LW] =
        DFBits.alias(left, left.width, 0, -right, left.getInit)
    }
    ///////////////////////////////////////////////////////////////////////////////////////////////////////////

    ///////////////////////////////////////////////////////////////////////////////////////////////////////////
    // DFBool
    ///////////////////////////////////////////////////////////////////////////////////////////////////////////
    implicit def fromDFBool : Builder[DFBool] = new Builder[DFBool] {
      def apply[P](left : DFBool, right : Checked[P]) : DFBool =
        DFBool.alias(left, 0, -right, left.getInit)
    }
    ///////////////////////////////////////////////////////////////////////////////////////////////////////////
  }

}
